<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Support IT - Suivi Outils</title>
  <link rel="stylesheet" href="style.css">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

  <header class="header">
    <h1>Support IT - Suivi Outils</h1>

    <div class="header-buttons">
      <button id="btnForm" class="btn active" onclick="showForm()">Formulaire</button>
      <button id="btnDash" class="btn btn-secondary" onclick="showDashboard()">Dashboard</button>
    </div>
  </header>


  <!-- ======================
        FORMULAIRE
  ======================= -->
  <section id="formCard" class="card">

    <h2>Formulaire de suivi</h2>

    <div class="form-group">
      <label>Matricule</label>
      <select id="matricule" onchange="loadUser()">
        <option value="">-- Choisir un matricule --</option>
      </select>
    </div>

    <div class="info-grid">

      <div>
        <label>Nom et Prénoms</label>
        <div id="nom" class="readonly"></div>
      </div>

      <div>
        <label>Statut</label>
        <div id="statut" class="readonly"></div>
      </div>

      <div>
        <label>Fonction</label>
        <div id="fonction" class="readonly"></div>
      </div>

      <div>
        <label>Rattachement</label>
        <div id="rattachement" class="readonly"></div>
      </div>

      <div>
        <label>Date d'intégration</label>
        <div id="dateIntegration" class="readonly"></div>
      </div>

      <div>
        <label>Login</label>
        <div id="login" class="readonly"></div>
      </div>

      <div>
        <label>Date de création</label>
        <div id="dateCreation" class="readonly"></div>
      </div>

      <div>
        <label>Date de deadline</label>
        <div id="deadline" class="readonly"></div>
      </div>

      <div>
        <label>Etat</label>
        <div id="etat" class="readonly status-box"></div>
      </div>

      <div>
        <label>Date Fin</label>
        <input type="text" id="dateFin" readonly />
      </div>

      <div>
        <label>Statut Suivi</label>
        <div id="statutSuivi" class="readonly"></div>
      </div>

    </div>


    <hr/>

    <h3>Outils</h3>

    <div id="outils"></div>

    <button class="btn btn-secondary" onclick="addOutil()">➕ Ajouter un outil</button>

    <span id="msg" class="msg-display"></span>

    <div class="actions">
      <button class="btn btn-primary" onclick="save()">Enregistrer</button>
    </div>

  </section>


  <!-- ======================
        DASHBOARD
  ======================= -->
  <section id="dashboardCard" class="card hidden">
    <h2>Dashboard - Récapitulatif</h2>

    <div class="dashboard-charts">
      <div class="chart-container">
        <h3>Statut Suivi (proportionnel)</h3>
        <canvas id="chartSuivi"></canvas>
      </div>
      <div class="chart-container">
        <h3>État Global (Terminé / En cours)</h3>
        <canvas id="chartEtat"></canvas>
      </div>
    </div>

    <div class="stats-row">
      <div class="stat-card">
        <label>Total</label>
        <div class="stat-value" id="statTotal">0</div>
      </div>
      <div class="stat-card">
        <label>En cours</label>
        <div class="stat-value" id="statEnCours">0</div>
      </div>
      <div class="stat-card stat-success">
        <label>Respecté</label>
        <div class="stat-value" id="statRespecte">0</div>
      </div>
      <div class="stat-card stat-danger">
        <label>Non respecté</label>
        <div class="stat-value" id="statNonRespecte">0</div>
      </div>
    </div>

    <div class="filters">
      <input type="text" id="searchBox" placeholder="Rechercher Matricule / Nom / Login" class="search-input">

      <select id="etatFilter">
        <option value="">Tous les Etats</option>
        <option value="En cours">En cours</option>
        <option value="Terminé">Terminé</option>
      </select>

      <select id="suiviFilter">
        <option value="">Tous les Statuts Suivi</option>
        <option value="Respecté">Respecté</option>
        <option value="Non respecté">Non respecté</option>
        <option value="En cours">En cours</option>
      </select>

      <button class="btn btn-secondary" onclick="loadDashboard()">Actualiser</button>
    </div>

    <div class="table-container">
      <table id="dashboardTable" class="dashboard-table">
        <thead>
          <tr>
            <th>Matricule</th>
            <th>Statut</th>
            <th>Nom</th>
            <th>Fonction</th>
            <th>Rattachement</th>
            <th>Date Integration</th>
            <th>Login</th>
            <th>Date Création</th>
            <th>Deadline</th>
            <th>Etat</th>
            <th>Date Fin</th>
            <th>Statut Suivi</th>
          </tr>
        </thead>

        <tbody></tbody>
      </table>
    </div>

  </section>


  <script src="script.js"></script>
</body>
</html>
