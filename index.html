<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Onboarding - IT</title>
  <link rel="icon" type="image/png" href="mathematiques.png">
  <link rel="stylesheet" href="style.css">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

  <!-- ====== SECTION LOGIN ====== -->
  <div id="loginSection" class="login-overlay">
    <div class="login-container">
      <div class="login-box">
        <div class="login-header">
          <h1>ğŸ” Authentification</h1>
          <p>Support IT - Suivi Outils</p>
        </div>
        
        <form id="loginForm" class="login-form">
          <div class="login-form-group">
            <label for="username">ğŸ‘¤ Utilisateur</label>
            <input 
              type="text" 
              id="username" 
              name="username" 
              placeholder="Entrez votre identifiant" 
              required 
              autocomplete="username"
            >
          </div>

          <div class="login-form-group">
            <label for="password">ğŸ”‘ Mot de passe</label>
            <input 
              type="password" 
              id="password" 
              name="password" 
              placeholder="Entrez votre mot de passe" 
              required 
              autocomplete="current-password"
            >
          </div>

          <div id="loginMessage" class="login-message"></div>

          <button type="submit" class="btn btn-login">
            ğŸš€ Se connecter
          </button>
        </form>
      </div>
    </div>
  </div>

  <header class="header">
    <h1>Support IT - Suivi Outils</h1>

    <div class="header-buttons">
      <button id="btnForm" class="btn active" onclick="showForm()">ğŸ“ Formulaire</button>
      <button id="btnDash" class="btn btn-secondary" onclick="showDashboard()">ğŸ“Š Dashboard</button>
      <button id="btnDetail" class="btn btn-secondary" onclick="showDetail()">ğŸ“‹ DÃ©tail</button>
    </div>
  </header>


  <!-- ======================
        FORMULAIRE
  ======================= -->
  <section id="formCard" class="card">

    <h2>ğŸ“ Formulaire de suivi</h2>

    <div class="form-group">
      <label>ğŸ‘¤ Matricule</label>
      <select id="matricule" onchange="loadUser()">
        <option value="">-- Choisir un matricule --</option>
      </select>
    </div>

    <div class="info-grid">

      <div>
        <label>ğŸ‘¤ Matricule</label>
        <div id="affichageMatricule" class="readonly" style="font-weight: bold; color: #0891b2;"></div>
      </div>

      <div>
        <label>ğŸ‘¥ Nom et PrÃ©noms</label>
        <div id="nom" class="readonly"></div>
      </div>

      <div>
        <label>âœ“ Statut</label>
        <div id="statut" class="readonly"></div>
      </div>

      <div>
        <label>ğŸ’¼ Fonction</label>
        <div id="fonction" class="readonly"></div>
      </div>

      <div>
        <label>ğŸ¢ Rattachement</label>
        <div id="rattachement" class="readonly"></div>
      </div>

      <div>
        <label>ğŸ“… Date d'intÃ©gration</label>
        <div id="dateIntegration" class="readonly"></div>
      </div>

      <div>
        <label>ğŸ” Login</label>
        <div id="login" class="readonly"></div>
      </div>

      <div>
        <label>ğŸ“† Date de crÃ©ation</label>
        <div id="dateCreation" class="readonly"></div>
      </div>

      <div>
        <label>â° Date de deadline</label>
        <div id="deadline" class="readonly"></div>
      </div>

      <div>
        <label>ğŸ¯ Etat</label>
        <div id="etat" class="readonly status-box"></div>
      </div>

      <div>
        <label>ğŸ Date Fin</label>
        <input type="text" id="dateFin" readonly />
      </div>

      <div>
        <label>ğŸ“Š Statut Suivi</label>
        <div id="statutSuivi" class="readonly"></div>
      </div>

    </div>


    <hr/>

    <h3>ğŸ› ï¸ Outils</h3>

    <div id="outils"></div>

    <button class="btn btn-secondary" onclick="addOutil()">â• Ajouter un outil</button>

    <span id="msg" class="msg-display"></span>

    <div class="actions">
      <button class="btn btn-primary" onclick="save()">ğŸ’¾ Enregistrer</button>
    </div>

  </section>


  <!-- ======================
        DASHBOARD
  ======================= -->
  <section id="dashboardCard" class="card hidden">
    <h2>ğŸ“Š Dashboard - RÃ©capitulatif</h2>

    <div class="dashboard-charts">
      <div class="chart-container">
        <h3>ğŸ“ˆ Statut Suivi (proportionnel)</h3>
        <canvas id="chartSuivi"></canvas>
      </div>
      <div class="chart-container">
        <h3>ğŸ¯ Ã‰tat Global (TerminÃ© / En cours)</h3>
        <canvas id="chartEtat"></canvas>
      </div>
    </div>

    <div class="stats-row">
      <div class="stat-card">
        <label>ğŸ“Š Total</label>
        <div class="stat-value" id="statTotal">0</div>
      </div>
      <div class="stat-card">
        <label>â³ En cours</label>
        <div class="stat-value" id="statEnCours">0</div>
      </div>
      <div class="stat-card stat-success">
        <label>âœ… RespectÃ©</label>
        <div class="stat-value" id="statRespecte">0</div>
      </div>
      <div class="stat-card stat-danger">
        <label>âŒ Non respectÃ©</label>
        <div class="stat-value" id="statNonRespecte">0</div>
      </div>
    </div>

    <div class="filters">
      <input type="text" id="searchBox" placeholder="ğŸ” Rechercher Matricule / Nom / Login" class="search-input">

      <select id="etatFilter">
        <option value="">ğŸ¯ Tous les Etats</option>
        <option value="En cours">â³ En cours</option>
        <option value="TerminÃ©">âœ… TerminÃ©</option>
      </select>

      <select id="suiviFilter">
        <option value="">ğŸ“ˆ Tous les Statuts Suivi</option>
        <option value="RespectÃ©">âœ… RespectÃ©</option>
        <option value="Non respectÃ©">âŒ Non respectÃ©</option>
        <option value="En cours">â³ En cours</option>
      </select>

      <button class="btn btn-secondary" onclick="loadDashboard()">ğŸ”„ Actualiser</button>
    </div>

    <div class="table-container">
      <table id="dashboardTable" class="dashboard-table">
        <thead>
          <tr>
            <th>ğŸ‘¤ Matricule</th>
            <th>âœ“ Statut</th>
            <th>ğŸ‘¥ Nom</th>
            <th>ğŸ’¼ Fonction</th>
            <th>ğŸ¢ Rattachement</th>
            <th>ğŸ” Login</th>
            <th>ğŸ“† Date CrÃ©ation</th>
            <th>â° Deadline</th>
            <th>ğŸ¯ Etat</th>
            <th>ğŸ Date Fin</th>
            <th>ğŸ“Š Statut Suivi</th>
            <th>âš™ï¸ Actions</th>
          </tr>
        </thead>

        <tbody></tbody>
      </table>
    </div>

  </section>


  <!-- ======================
        DETAIL OUTILS
  ======================= -->
  <section id="detailCard" class="card hidden">
    <h2>ğŸ“‹ Liste des outils par collaborateur</h2>

    <!-- Filtres -->
    <div class="filters-container">
      <div class="filter-group">
        <label for="filterDetailMatricule">ğŸ‘¤ Filtrer par Matricule</label>
        <select id="filterDetailMatricule" onchange="applyDetailFilters()">
          <option value="">-- Tous les matricules --</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="filterDetailFonction">ğŸ’¼ Filtrer par Fonction</label>
        <select id="filterDetailFonction" onchange="applyDetailFilters()">
          <option value="">-- Toutes les fonctions --</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="filterDetailRattachement">ğŸ¢ Filtrer par Rattachement</label>
        <select id="filterDetailRattachement" onchange="applyDetailFilters()">
          <option value="">-- Tous les rattachements --</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="filterDetailStatut">âœ“ Filtrer par Statut</label>
        <select id="filterDetailStatut" onchange="applyDetailFilters()">
          <option value="">-- Tous les statuts --</option>
          <option value="En cours">â³ En cours</option>
          <option value="TerminÃ©">âœ… TerminÃ©</option>
        </select>
      </div>

      <button class="btn btn-secondary" onclick="resetDetailFilters()">ğŸ”„ RÃ©initialiser</button>
    </div>

    <!-- Tableau -->
    <div class="table-container">
      <table class="data-table">
        <thead>
          <tr>
            <th>ğŸ‘¤ Matricule</th>
            <th>ğŸ‘¥ Nom</th>
            <th>ğŸ’¼ Fonction</th>
            <th>ğŸ¢ Rattachement</th>
            <th>ğŸ” Login</th>
            <th>ğŸ› ï¸ Outil</th>
            <th>ğŸŸï¸ NÂ° Ticket</th>
            <th>âœ“ Statut</th>
            <th>ğŸ“… Date DÃ©but</th>
            <th>ğŸ Date Fin</th>
            <th>âš™ï¸ Actions</th>
          </tr>
        </thead>
        <tbody id="detailTableBody">
        </tbody>
      </table>
    </div>

    <div id="detailEmptyMessage" style="text-align: center; padding: 20px; color: #999; display: none;">
      Aucune donnÃ©e Ã  afficher
    </div>

  </section>


  <!-- ======================
        MODAL DETAILS OUTILS
  ======================= -->
  <div id="detailsModal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3><span id="detailsModalMatricule">--</span> <span id="detailsModalNom"></span></h3>
        <button class="modal-close" onclick="closeDetails()">âœ•</button>
      </div>
      <div class="modal-body">
        <!-- Infos gÃ©nÃ©rales -->
        <div class="details-info">
          <div class="info-item">
            <label>ğŸ“… Date de crÃ©ation (Login)</label>
            <div class="info-value" id="detailsDateCreation">-</div>
          </div>
          <div class="info-item">
            <label>â° Deadline</label>
            <div class="info-value" id="detailsDeadline">-</div>
          </div>
        </div>

        <!-- SÃ©parateur -->
        <hr style="margin: 20px 0; border: none; border-top: 1px solid #e6e9ee;">

        <!-- DÃ©tail des outils -->
        <h4 style="margin: 0 0 15px 0; color: var(--muted); font-size: 13px; font-weight: 600;">DÃ©tail des outils</h4>
        <table class="details-table">
          <thead>
            <tr>
              <th>Outil</th>
              <th>Statut</th>
              <th>Date DÃ©but</th>
              <th>Date Fin</th>
            </tr>
          </thead>
          <tbody id="detailsTableBody">
          </tbody>
        </table>
      </div>
      <!-- <div class="modal-footer">
        <button class="btn custom-btn" onclick="closeDetails()">âœ• Fermer</button>

      </div> -->
    </div>
  </div>


  <script src="script.js"></script>
</body>
</html>
